import{d as $,u as _,r as c,j as e,L as Q,c as X}from"./index-BaUkKamr.js";import{a as h}from"./index-Dq7h7Pqt.js";/* empty css                */import{h as Z,i as ee,j as ae,k as ne,l as le}from"./index-D0JyTGRv.js";import te from"./CreateChannel-B5qQ5L8H.js";function se(){const{sidebarOpen:q}=$(),{user:i}=_(),[s,p]=c.useState(null),[N,x]=c.useState([]),[w,v]=c.useState(null),[g,E]=c.useState(!1),[I,U]=c.useState(!0),[B,R]=c.useState(null),[M,f]=c.useState(!1),[z,y]=c.useState(!1),[D,C]=c.useState(null),b={title:"",videoLink:"",thumbnail:"",description:"",category:""},[n,u]=c.useState(b),[o,m]=c.useState(!1),[T,k]=c.useState(!1),[r,V]=c.useState({channelName:"",channelBanner:"",channelPic:"",description:""}),[L,S]=c.useState(!1);c.useEffect(()=>{i?.channelId&&(U(!0),R(null),h.get(`https://youtube-backend-cx37.onrender.com/api/channel/${i.channelId}`).then(a=>{p(a.data),x(a.data.videos||[])}).catch(a=>{R("Failed to load channel.")}).finally(()=>U(!1)))},[i?.channelId]);const F=180,P=s&&s.description&&s.description.length>F,A=s&&s.description?g?s.description:s.description.slice(0,F):"",O=async a=>{if(window.confirm("Delete this video?"))try{await h.delete(`https://youtube-backend-cx37.onrender.com/api/video/${a}`,{headers:{Authorization:`Bearer ${i.token}`}}),x(l=>l.filter(t=>t._id!==a)),v(null)}catch{alert("Failed to delete video")}},W=()=>{u(b),f(!0)},H=a=>{const l=N.find(t=>t._id===a);l&&(C(l),u({title:l.title||"",videoLink:l.videoLink||"",thumbnail:l.thumbnail||"",description:l.description||"",category:l.category||""}),y(!0)),v(null)},Y=async a=>{a.preventDefault(),m(!0);const l={title:n.title.trim(),videoLink:n.videoLink.trim(),thumbnail:n.thumbnail.trim(),description:n.description.trim(),category:n.category.trim()};if(!l.title||!l.videoLink||!l.thumbnail){alert("Please fill in all required fields."),m(!1);return}try{await h.post("https://youtube-backend-cx37.onrender.com/api/video",l,{headers:{Authorization:`Bearer ${i.token}`}});const t=await h.get(`https://youtube-backend-cx37.onrender.com/api/channel/${i.channelId}`);p(t.data),x(t.data.videos||[]),f(!1),u(b)}catch(t){alert("Failed to upload video: "+(t.response?.data?.message||t.message))}finally{m(!1)}},G=async a=>{if(a.preventDefault(),!D)return;m(!0);const l={title:n.title.trim(),videoLink:n.videoLink.trim(),thumbnail:n.thumbnail.trim(),description:n.description.trim(),category:n.category.trim()};if(!l.title||!l.videoLink||!l.thumbnail){alert("Please fill in all required fields."),m(!1);return}try{await h.put(`https://youtube-backend-cx37.onrender.com/api/video/${D._id}`,l,{headers:{Authorization:`Bearer ${i.token}`}});const t=await h.get(`https://youtube-backend-cx37.onrender.com/api/channel/${i.channelId}`);p(t.data),x(t.data.videos||[]),y(!1),C(null),u(b)}catch(t){alert("Failed to update video: "+(t.response?.data?.message||t.message))}finally{m(!1)}},J=()=>{V({channelName:s.channelName||"",channelBanner:s.channelBanner||"",channelPic:s.channelPic||"",description:s.description||""}),k(!0)},j=a=>{V({...r,[a.target.name]:a.target.value})},K=async a=>{a.preventDefault(),S(!0);const l={channelName:r.channelName.trim(),channelBanner:r.channelBanner.trim(),channelPic:r.channelPic.trim(),description:r.description.trim()};if(!l.channelName){alert("Channel name is required."),S(!1);return}try{await h.put(`https://youtube-backend-cx37.onrender.com/api/updateChannel/${s._id}`,l,{headers:{Authorization:`Bearer ${i.token}`}});const t=await h.get(`https://youtube-backend-cx37.onrender.com/api/channel/${i.channelId}`);p(t.data),k(!1)}catch(t){alert("Failed to update channel: "+(t.response?.data?.message||t.message))}finally{S(!1)}},d=a=>{u({...n,[a.target.name]:a.target.value})};return I?e.jsx("div",{style:{padding:32},children:"Loading..."}):B?e.jsx("div",{style:{padding:32,color:"red"},children:B}):s?e.jsxs("div",{className:"channel-page",style:{flex:1},children:[T&&e.jsx("div",{className:"edit-channel-modal-bg",children:e.jsxs("div",{className:"edit-channel-modal",children:[e.jsx("h2",{className:"edit-channel-title",children:"Edit Channel Details"}),e.jsxs("form",{className:"edit-channel-form",onSubmit:K,children:[e.jsx("label",{className:"edit-channel-label",children:"Channel Name"}),e.jsx("input",{className:"edit-channel-input",name:"channelName",type:"text",placeholder:"Channel name",value:r.channelName,onChange:j,required:!0,autoFocus:!0}),e.jsx("label",{className:"edit-channel-label",children:"Description"}),e.jsx("textarea",{className:"edit-channel-input",name:"description",placeholder:"Channel description",value:r.description,onChange:j,rows:3}),e.jsx("label",{className:"edit-channel-label",children:"Banner URL"}),e.jsx("input",{className:"edit-channel-input",name:"channelBanner",type:"url",placeholder:"Banner image URL",value:r.channelBanner,onChange:j}),e.jsx("img",{src:r.channelBanner||"https://placehold.co/600x150.png?text=Banner",alt:"Banner preview",className:"edit-channel-banner-preview"}),e.jsx("label",{className:"edit-channel-label",children:"Channel Picture URL"}),e.jsx("input",{className:"edit-channel-input",name:"channelPic",type:"url",placeholder:"Channel picture URL",value:r.channelPic,onChange:j}),e.jsx("img",{src:r.channelPic||"https://placehold.co/100x100.png?text=channel",alt:"Avatar preview",className:"edit-channel-avatar-preview"}),e.jsxs("div",{className:"edit-channel-actions",children:[e.jsxs("button",{type:"button",className:"edit-channel-cancel",onClick:()=>k(!1),disabled:L,children:[e.jsx(Z,{style:{marginRight:6}}),"Cancel"]}),e.jsxs("button",{type:"submit",className:"edit-channel-save",disabled:L||!r.channelName,children:[e.jsx(ee,{style:{marginRight:6}}),L?"Saving...":"Save"]})]})]})]})}),M&&e.jsx("div",{className:"create-channel-modal-bg",style:{zIndex:3e3},children:e.jsxs("div",{className:"create-channel-modal",style:{maxWidth:500},children:[e.jsx("h2",{className:"create-channel-title",children:"Upload Video"}),e.jsxs("form",{className:"create-channel-form",onSubmit:Y,children:[e.jsxs("div",{className:"create-channel-fields",children:[e.jsx("label",{className:"create-channel-label",children:"Title"}),e.jsx("input",{className:"create-channel-input",name:"title",type:"text",placeholder:"Video title",value:n.title,onChange:d,required:!0,autoFocus:!0}),e.jsx("label",{className:"create-channel-label",children:"Video Link (URL)"}),e.jsx("input",{className:"create-channel-input",name:"videoLink",type:"url",placeholder:"Video file URL",value:n.videoLink,onChange:d,required:!0}),e.jsx("label",{className:"create-channel-label",children:"Thumbnail URL"}),e.jsx("input",{className:"create-channel-input",name:"thumbnail",type:"url",placeholder:"Thumbnail image URL",value:n.thumbnail,onChange:d,required:!0}),e.jsx("label",{className:"create-channel-label",children:"Description"}),e.jsx("textarea",{className:"create-channel-input",name:"description",placeholder:"Video description",value:n.description,onChange:d,rows:2}),e.jsx("label",{className:"create-channel-label",children:"Category"}),e.jsx("input",{className:"create-channel-input",name:"category",type:"text",placeholder:"Category",value:n.category,onChange:d})]}),e.jsxs("div",{className:"create-channel-actions",children:[e.jsx("button",{type:"button",className:"create-channel-cancel",onClick:()=>f(!1),disabled:o,children:"Cancel"}),e.jsx("button",{type:"submit",className:"create-channel-submit",disabled:!n.title||!n.videoLink||!n.thumbnail||o,children:o?"Uploading...":"Upload"})]})]})]})}),z&&e.jsx("div",{className:"create-channel-modal-bg",style:{zIndex:3e3},children:e.jsxs("div",{className:"create-channel-modal",style:{maxWidth:500},children:[e.jsx("h2",{className:"create-channel-title",children:"Edit Video"}),e.jsxs("form",{className:"create-channel-form",onSubmit:G,children:[e.jsxs("div",{className:"create-channel-fields",children:[e.jsx("label",{className:"create-channel-label",children:"Title"}),e.jsx("input",{className:"create-channel-input",name:"title",type:"text",placeholder:"Video title",value:n.title,onChange:d,required:!0,autoFocus:!0}),e.jsx("label",{className:"create-channel-label",children:"Video Link (URL)"}),e.jsx("input",{className:"create-channel-input",name:"videoLink",type:"url",placeholder:"Video file URL",value:n.videoLink,onChange:d,required:!0}),e.jsx("label",{className:"create-channel-label",children:"Thumbnail URL"}),e.jsx("input",{className:"create-channel-input",name:"thumbnail",type:"url",placeholder:"Thumbnail image URL",value:n.thumbnail,onChange:d,required:!0}),e.jsx("label",{className:"create-channel-label",children:"Description"}),e.jsx("textarea",{className:"create-channel-input",name:"description",placeholder:"Video description",value:n.description,onChange:d,rows:2}),e.jsx("label",{className:"create-channel-label",children:"Category"}),e.jsx("input",{className:"create-channel-input",name:"category",type:"text",placeholder:"Category",value:n.category,onChange:d})]}),e.jsxs("div",{className:"create-channel-actions",children:[e.jsx("button",{type:"button",className:"create-channel-cancel",onClick:()=>{y(!1),C(null)},disabled:o,children:"Cancel"}),e.jsx("button",{type:"submit",className:"create-channel-submit",disabled:!n.title||!n.videoLink||!n.thumbnail||o,children:o?"Saving...":"Save"})]})]})]})}),e.jsx("div",{className:"channel-banner-container",children:e.jsx("img",{className:"channel-banner",src:s.channelBanner||"https://placehold.co/600x150.png?text=Banner",alt:"Channel banner"})}),e.jsxs("div",{className:"channel-header",children:[e.jsx("img",{className:"channel-avatar",src:s.channelPic||"https://placehold.co/100x100.png?text=channel",alt:s.channelName}),e.jsxs("div",{className:"channel-info",children:[e.jsx("div",{className:"channel-title",children:s.channelName}),e.jsxs("div",{className:"channel-meta",children:[e.jsxs("span",{className:"channel-handle",children:["@",s.channelName?.toLowerCase().replace(/\s/g,""),"-ic4ou"]}),e.jsx("span",{className:"channel-dot",children:"·"}),e.jsxs("span",{className:"channel-subs",children:[s.subscribers," subscribers"]}),e.jsx("span",{className:"channel-dot",children:"·"}),e.jsxs("span",{className:"channel-videos",children:[N.length," videos"]})]}),e.jsxs("div",{className:"channel-desc",children:[A,P&&!g&&e.jsx("span",{className:"desc-more",onClick:()=>E(!0),children:"...more"}),P&&g&&e.jsx("span",{className:"desc-less",onClick:()=>E(!1),children:" Show less"})]}),e.jsxs("div",{className:"channel-actions",children:[e.jsxs("button",{className:"channel-btn",onClick:W,children:[e.jsx(ae,{style:{marginRight:6,fontSize:"1.2rem"}}),"Upload video"]}),e.jsx("button",{className:"channel-btn",onClick:J,children:"Customize channel"}),e.jsx("button",{className:"channel-btn secondary",children:"Manage videos"})]})]})]}),e.jsxs("div",{className:"channel-tabs",children:[e.jsx("div",{className:"channel-tab",children:"Home"}),e.jsx("div",{className:"channel-tab active",children:"Videos"}),e.jsx("div",{className:"channel-tab",children:"Shorts"}),e.jsx("div",{className:"channel-tab",children:"Playlists"}),e.jsx("div",{className:"channel-tab",children:"Posts"})]}),e.jsx("div",{className:"channel-videos-list",children:N.map(a=>e.jsxs("div",{className:"channel-video-card",children:[e.jsx(Q,{to:`/video/${a._id}`,children:e.jsx("img",{className:"channel-video-thumb",src:a.thumbnail,alt:a.title})}),e.jsxs("div",{className:"channel-video-info",children:[e.jsx("div",{className:"channel-video-title",children:a.title}),e.jsxs("div",{className:"channel-video-meta",children:[e.jsxs("span",{children:[a.views," views"]}),e.jsx("span",{className:"channel-dot",children:"·"}),e.jsx("span",{children:a.uploadDate?new Date(a.uploadDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):""})]})]}),e.jsx("div",{className:"channel-video-actions",children:e.jsxs("span",{className:"channel-video-meatball",tabIndex:0,onClick:()=>v(w===a._id?null:a._id),children:[e.jsx(X,{}),w===a._id&&e.jsxs("div",{className:"channel-video-dropdown",children:[e.jsxs("button",{className:"channel-video-dropdown-item",onClick:()=>H(a._id),children:[e.jsx(ne,{style:{marginRight:6}})," Edit"]}),e.jsxs("button",{className:"channel-video-dropdown-item delete",onClick:()=>O(a._id),children:[e.jsx(le,{style:{marginRight:6}})," Delete"]})]})]})})]},a._id))})]}):null}function oe(){const{sidebarOpen:q}=$(),{user:i}=_();return e.jsx("div",{className:"channel-page",children:i?.channelId?e.jsx(se,{}):e.jsx(te,{})})}export{oe as default};
